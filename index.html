
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="UTF-8">

    <title>Find the nearest Centers of Permaculture and Appropriate Technology</title>

    <link href="/apis/fusiontables/docs/samples/style/default.css"
        rel="stylesheet" type="text/css">
		<link rel="stylesheet" href="styles/styles.css" />
		<link rel="stylesheet" href="styles/jquery.mobile-1.3.2.min.css" />
		<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
        	    <script src="js/jquery-2.0.3.min.js"></script>
		<script src="js/jquery.mobile-1.3.2.min.js"></script>
<script>
// table ID 1Rd6n3I6jogBxx_1Mgy2xi8SdJQwHcnvahcrmKSk, cycling deaths 2005-2011 chicago
// api key: AIzaSyCSjvPQXDkjxppQfiaiPFfl0HwprmUndKM
// https://www.googleapis.com/fusiontables/v1/tables/1Rd6n3I6jogBxx_1Mgy2xi8SdJQwHcnvahcrmKSk
</script>
    <script type="text/javascript">
		
      function onLocationFound(e) {
      	var radius = e.coords.accuracy / 2;
      	var lat = e.coords.latitude;
      	var lng = e.coords.longitude;

        var map = new google.maps.Map(document.getElementById('map'), {
          center: new google.maps.LatLng(lat, lng),
          zoom: 12,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        });

        var layer = new google.maps.FusionTablesLayer({
            query: {
              select: 'latitude',
              from: '1Rd6n3I6jogBxx_1Mgy2xi8SdJQwHcnvahcrmKSk',
              //orderBy: 'ST_DISTANCE(address, LATLNG(' + lat + ',' + lng + '))',
 //             limit: 3
         }
       });
         layer.setMap(map);
      } // end onLocationFound
      
      google.maps.event.addDomListener(window, 'load', getLocation);
      
	function onLocationError(msg) {
		var s = document.querySelector('#status');
		s.innerHTML = typeof msg == 'string' ? msg : "failed";
		s.className = 'fail';
		
		// console.log(arguments);
	}

	function getLocation() {
		locationOptions = { maximumAge: 30000, timeout: 30000, enableHighAccuracy: true }; // don't allow old data
		navigator.geolocation.getCurrentPosition(onLocationFound, onLocationError, locationOptions);
	} 
    </script>
  </head>
  <body>
  <div data-role="page" id="home_page">
	<div data-role="content">
  <h1>Permaculture and Appropriate Technology</h1>
  <h2>Nearest centers</h2>
    <div id="map"></div>
   <div id='list'>
   <h2>List</h2>
   </div>
   <h2>Info</h2>
   <ul data-role="listview" data-inset="true">
	   <li>What is Permaculture?</li>
	   <li>What is Appropriate Technology?</li>
   </ul>
	</div>
  </div>
  </body>
</html>